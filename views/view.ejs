<!doctype html>

<html lang="en" class=" layout-navbar-fixed layout-menu-fixed layout-compact " dir="ltr" data-skin="default"
    data-assets-path="../../assets/" data-template="vertical-menu-template" data-bs-theme="light">

<!-- Mirrored from demos.themeselection.com/sneat-bootstrap-html-admin-template/html/vertical-menu-template/form-layouts-vertical.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 19 Jul 2025 20:47:10 GMT -->

<head>
    <meta charset="utf-8" />
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <meta name="robots" content="noindex, nofollow" />


    <title>Cardify</title>

    <link rel="icon" type="image/x-icon" href="../../assets/cardifylogo2.png" />


    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&amp;display=swap"
        rel="stylesheet" />

    <link rel="stylesheet" href="../../assets/vendor/fonts/iconify-icons.css" />

    <!-- Core CSS -->
    <!-- build:css assets/vendor/css/theme.css  -->


    <link rel="stylesheet" href="../../assets/vendor/libs/pickr/pickr-themes.css" />

    <link rel="stylesheet" href="../../assets/vendor/css/core.css" />
    <link rel="stylesheet" href="../../assets/css/demo.css" />


    <!-- Vendors CSS -->

    <link rel="stylesheet" href="../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <!-- endbuild -->

    <link rel="stylesheet" href="../../assets/vendor/libs/flatpickr/flatpickr.css" />
    <link rel="stylesheet" href="../../assets/vendor/libs/select2/select2.css" />

    <!-- Page CSS -->


    <!-- Helpers -->
    <script src="../../assets/vendor/js/helpers.js"></script>
    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->

    <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
    <script src="../../assets/vendor/js/template-customizer.js"></script>

    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->

    <script src="../../assets/js/config.js"></script>

</head>

<body>



    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar  ">
        <div class="layout-container">

            <!-- Menu -->

            <%-include('sidebar.ejs')-%>

                <div class="menu-mobile-toggler d-xl-none rounded-1">
                    <a href="javascript:void(0);"
                        class="layout-menu-toggle menu-link text-large text-bg-secondary p-2 rounded-1">
                        <i class="bx bx-menu icon-base"></i>
                        <i class="bx bx-chevron-right icon-base"></i>
                    </a>
                </div>
                <!-- / Menu -->



                <!-- Layout container -->
                <div class="layout-page">


                    <%-include('header.ejs')-%>

                        <!-- / Navbar -->


                        <!-- Content wrapper -->
                        <div class="content-wrapper">
                            <!-- Content -->
                            <div class="container-xxl flex-grow-1 container-p-y">

                                <!-- Basic Layout -->
                                <div class="row mb-6 gy-6">

                                </div>

                                <!-- Multi Column with Form Separator -->
                                <!-- <div class="card mb-6">
    <h5 class="card-header">Multi Column with Form Separator</h5>
    <form class="card-body">
      <h6>1. Account Details</h6>
      <div class="row g-6">
        <div class="col-md-6">
          <label class="form-label" for="multicol-username">Username</label>
          <input type="text" id="multicol-username" class="form-control" placeholder="john.doe" />
        </div>
        <div class="col-md-6">
          <label class="form-label" for="multicol-email">Email</label>
          <div class="input-group input-group-merge">
            <input type="text" id="multicol-email" class="form-control" placeholder="john.doe" aria-label="john.doe" aria-describedby="multicol-email2" />
            <span class="input-group-text" id="multicol-email2">@example.com</span>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-password-toggle">
            <label class="form-label" for="multicol-password">Password</label>
            <div class="input-group input-group-merge">
              <input type="password" id="multicol-password" class="form-control" placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;" aria-describedby="multicol-password2" />
              <span class="input-group-text cursor-pointer" id="multicol-password2"><i class="icon-base bx bx-hide"></i></span>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="form-password-toggle">
            <label class="form-label" for="multicol-confirm-password">Confirm Password</label>
            <div class="input-group input-group-merge">
              <input type="password" id="multicol-confirm-password" class="form-control" placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;" aria-describedby="multicol-confirm-password2" />
              <span class="input-group-text cursor-pointer" id="multicol-confirm-password2"><i class="icon-base bx bx-hide"></i></span>
            </div>
          </div>
        </div>
      </div>
      <hr class="my-6 mx-n6" />
      <h6>2. Personal Info</h6>
      <div class="row g-6">
        <div class="col-md-6">
          <label class="form-label" for="multicol-first-name">First Name</label>
          <input type="text" id="multicol-first-name" class="form-control" placeholder="John" />
        </div>
        <div class="col-md-6">
          <label class="form-label" for="multicol-last-name">Last Name</label>
          <input type="text" id="multicol-last-name" class="form-control" placeholder="Doe" />
        </div>
        <div class="col-md-6">
          <label class="form-label" for="multicol-country">Country</label>
          <select id="multicol-country" class="select2 form-select" data-allow-clear="true">
            <option value="">Select</option>
            <option value="Australia">Australia</option>
            <option value="Bangladesh">Bangladesh</option>
            <option value="Belarus">Belarus</option>
            <option value="Brazil">Brazil</option>
            <option value="Canada">Canada</option>
            <option value="China">China</option>
            <option value="France">France</option>
            <option value="Germany">Germany</option>
            <option value="India">India</option>
            <option value="Indonesia">Indonesia</option>
            <option value="Israel">Israel</option>
            <option value="Italy">Italy</option>
            <option value="Japan">Japan</option>
            <option value="Korea">Korea, Republic of</option>
            <option value="Mexico">Mexico</option>
            <option value="Philippines">Philippines</option>
            <option value="Russia">Russian Federation</option>
            <option value="South Africa">South Africa</option>
            <option value="Thailand">Thailand</option>
            <option value="Turkey">Turkey</option>
            <option value="Ukraine">Ukraine</option>
            <option value="United Arab Emirates">United Arab Emirates</option>
            <option value="United Kingdom">United Kingdom</option>
            <option value="United States">United States</option>
          </select>
        </div>
        <div class="col-md-6 select2-primary">
          <label class="form-label" for="multicol-language">Language</label>
          <select id="multicol-language" class="select2 form-select" multiple>
            <option value="en" selected>English</option>
            <option value="fr" selected>French</option>
            <option value="de">German</option>
            <option value="pt">Portuguese</option>
          </select>
        </div>
        <div class="col-md-6">
          <label class="form-label" for="multicol-birthdate">Birth Date</label>
          <input type="text" id="multicol-birthdate" class="form-control dob-picker" placeholder="YYYY-MM-DD" />
        </div>
        <div class="col-md-6">
          <label class="form-label" for="multicol-phone">Phone No</label>
          <input type="text" id="multicol-phone" class="form-control phone-mask" placeholder="658 799 8941" aria-label="658 799 8941" />
        </div>
      </div>
      <div class="pt-6">
        <button type="submit" class="btn btn-primary me-3">Submit</button>
        <button type="reset" class="btn btn-label-secondary">Cancel</button>
      </div>
    </form>
  </div> -->

                                <% if (event) { %>
                                    <!-- ðŸŸ¦ Event Details -->
                                    <div class="card mb-4">
                                        <h5 class="card-header">Event: <%= event.event_name %>
                                        </h5>
                                        <div class="card-body">
                                            <p><strong>Description:</strong>
                                                <%= event.description %>
                                            </p>
                                            <p><strong>Location:</strong>
                                                <%= event.location %>
                                            </p>
                                            <p><strong>Date:</strong>
                                                <%= new Date(event.event_date).toLocaleDateString() %>
                                            </p>
                                            <p><strong>Start Time:</strong>
                                                <%= new Date(event.start_time).toLocaleTimeString([], { hour: '2-digit'
                                                    , minute: '2-digit' }) %>
                                            </p>
                                            <p><strong>End Time:</strong>
                                                <%= new Date(event.end_time).toLocaleTimeString([], { hour: '2-digit' ,
                                                    minute: '2-digit' }) %>
                                            </p>
                                        </div>
                                    </div>

                                    <!-- ðŸŸ© Add Guest Form -->
                                    <div class="card mb-4">
                                        <h5 class="card-header">Add Security</h5>
                                        <form id="securityForm" class="card-body row g-4">
                                            <input type="hidden" name="event_id" value="<%= event.id %>">

                                            <div class="col-md-6">
                                                <label class="form-label">First Name</label>
                                                <input type="text" name="firstname" class="form-control" required />
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Last Name</label>
                                                <input type="text" name="lastname" class="form-control" required />
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Phone</label>
                                                <input type="text" name="phone" class="form-control" />
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Email</label>
                                                <input type="email" name="email" class="form-control" required />
                                            </div>
                                            <div class="col-md-6">
                                                <label class="form-label">Password</label>
                                                <input type="password" name="password" class="form-control" required />
                                            </div>

                                            <div class="col-12">
                                                <button type="submit" class="btn btn-primary">Add Security</button>
                                            </div>
                                        </form>
                                    </div>

                                    <!-- ðŸŸ¦ Securities Table -->
                                    <div class="card">
                                        <h5 class="card-header">Security List</h5>
                                        <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                            <table class="table table-striped table-hover">
                                                <thead class="table-light sticky-top">
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Full Name</th>
                                                        <th>Email</th>
                                                        <th>Phone</th>
                                                    </tr>
                                                </thead>
                                                <tbody id="securityTableBody">
                                                    <% if (event.Securities && event.Securities.length> 0) { %>
                                                        <% event.Securities.forEach((s, i)=> { %>
                                                            <tr>
                                                                <td>
                                                                    <%= i + 1 %>
                                                                </td>
                                                                <td>
                                                                    <%= s.first_name %>
                                                                        <%= s.last_name %>
                                                                </td>
                                                                <td>
                                                                    <%= s.email %>
                                                                </td>
                                                                <td>
                                                                    <%= s.phone %>
                                                                </td>
                                                            </tr>
                                                            <% }) %>
                                                                <% } else { %>
                                                                    <tr>
                                                                        <td colspan="4" class="text-center text-muted">
                                                                            No securities added yet.</td>
                                                                    </tr>
                                                                    <% } %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- ðŸŸ¥ Guest Table (Scrollable) -->
                                    <div class="card">
                                        <h5 class="card-header">Guest List</h5>
                                        <div class="table-responsive" style="max-height: 400px; overflow-y: auto;">
                                            <table class="table table-striped table-hover">
                                                <thead class="table-light sticky-top">
                                                    <tr>
                                                        <th>#</th>
                                                        <th>Guest Name</th>
                                                        <th>Email</th>
                                                        <th>Phone</th>
                                                        <th>Card Type</th>
                                                        <th>RSVP</th>
                                                        <th>QR Code</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <% if (event.Guests && event.Guests.length> 0) { %>
                                                        <% event.Guests.forEach((g, i)=> { %>
                                                            <tr>
                                                                <td>
                                                                    <%= i + 1 %>
                                                                </td>
                                                                <td>
                                                                    <%= g.guest_name %>
                                                                </td>
                                                                <td>
                                                                    <%= g.email %>
                                                                </td>
                                                                <td>
                                                                    <%= g.phone %>
                                                                </td>
                                                                <td>
                                                                    <%= g.card_type %>
                                                                </td>
                                                                <td>
                                                                    <%= g.rsvp_status %>
                                                                </td>
                                                                <td>
                                                                    <% if (g.qr_code) { %>
                                                                        <img src="<%= g.qr_code %>" alt="QR"
                                                                            width="60" />
                                                                        <% } else { %>
                                                                            <span class="text-muted">N/A</span>
                                                                            <% } %>
                                                                </td>
                                                            </tr>
                                                            <% }) %>
                                                                <% } else { %>
                                                                    <tr>
                                                                        <td colspan="7" class="text-center text-muted">
                                                                            No guests added yet.</td>
                                                                    </tr>
                                                                    <% } %>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    <% } else { %>
                                        <p class="text-danger">No event data found.</p>
                                        <% } %>


                                            <!-- Form with Tabs -->



                            </div>
                            <!-- / Content -->




                            <!-- Footer -->
                            <footer class="content-footer footer bg-footer-theme">
                                <div class="container-xxl">
                                    <div
                                        class="footer-container d-flex align-items-center justify-content-between py-4 flex-md-row flex-column">
                                        <div class="mb-2 mb-md-0">
                                            Â©
                                            <script>
                                                document.write(new Date().getFullYear());
                                            </script>
                                            ,cardifyTz
                                        </div>

                                    </div>
                                </div>
                            </footer>
                            <!-- / Footer -->


                            <div class="content-backdrop fade"></div>
                        </div>
                        <!-- Content wrapper -->
                </div>
                <!-- / Layout page -->
        </div>



        <!-- Overlay -->
        <div class="layout-overlay layout-menu-toggle"></div>


        <!-- Drag Target Area To SlideIn Menu On Small Screens -->
        <div class="drag-target"></div>

    </div>
    <!-- / Layout wrapper -->





    <!-- Core JS -->
    <!-- build:js assets/vendor/js/theme.js  -->


    <script src="../../assets/vendor/libs/jquery/jquery.js"></script>

    <script src="../../assets/vendor/libs/popper/popper.js"></script>
    <script src="../../assets/vendor/js/bootstrap.js"></script>
    <script src="../../assets/vendor/libs/%40algolia/autocomplete-js.js"></script>



    <script src="../../assets/vendor/libs/pickr/pickr.js"></script>



    <script src="../../assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>


    <script src="../../assets/vendor/libs/hammer/hammer.js"></script>

    <script src="../../assets/vendor/libs/i18n/i18n.js"></script>


    <script src="../../assets/vendor/js/menu.js"></script>

    <!-- endbuild -->

    <!-- Vendors JS -->
    <script src="../../assets/vendor/libs/cleave-zen/cleave-zen.js"></script>
    <script src="../../assets/vendor/libs/moment/moment.js"></script>
    <script src="../../assets/vendor/libs/flatpickr/flatpickr.js"></script>
    <script src="../../assets/vendor/libs/select2/select2.js"></script>

    <!-- Main JS -->

    <script src="../../assets/js/main.js"></script>


    <!-- Page JS -->
    <script src="../../assets/js/form-layouts.js"></script>
    <script>
        window.addEventListener('pageshow', function (event) {
            if (event.persisted || (window.performance && window.performance.navigation.type === 2)) {
                // If coming from bfcache (Back/Forward cache), reload to enforce revalidation
                window.location.reload();
            }
        });

        $('#securityForm').on('submit', function (e) {
            e.preventDefault();
            const firstname = $('input[name="firstname"]').val().trim();
            const lastname = $('input[name="lastname"]').val().trim();
            const phone = $('input[name="phone"]').val().trim();
            const email = $('input[name="email"]').val().trim();
            const password = $('input[name="password"]').val().trim();
            const event_id = $('input[name="event_id"]').val();

            // âœ… Validation
            if (!firstname || !lastname || !email || !password || !event_id) {
                showToast('Validation Error', 'Please fill in all required fields.', 'text-warning');
                return;
            }
            const formData = {
                firstname: $('input[name="firstname"]').val().trim(),
                lastname: $('input[name="lastname"]').val().trim(),
                phone: $('input[name="phone"]').val().trim(),
                email: $('input[name="email"]').val().trim(),
                password: $('input[name="password"]').val().trim(),
                event_id: $('input[name="event_id"]').val()
            };

            $.ajax({
                type: 'POST',
                url: '/user/security',
                contentType: 'application/json',
                data: JSON.stringify(formData),
                beforeSend: function () {
                    $('#securityForm button[type="submit"]').prop('disabled', true);
                },
                success: function (res) {
                    showToast('Success', 'Security added.', 'text-success');
                    $('#securityForm')[0].reset();
                    $('#securityForm button[type="submit"]').prop('disabled', false);

                    const tbody = $('#securityTableBody');

                    if (tbody.find('td').hasClass('text-muted')) {
                        tbody.empty(); // remove "no securities" row
                    }

                    const rowCount = tbody.find('tr').length + 1;

                    const newRow = `
        <tr>
          <td>${rowCount}</td>
          <td>${formData.firstname} ${formData.lastname}</td>
          <td>${formData.email}</td>
          <td>${formData.phone}</td>
        </tr>
      `;

                    tbody.append(newRow);
                },
                error: function (xhr) {
                    const message = xhr.responseJSON?.message || 'Failed to add security.';
                    showToast('Error', message, 'text-danger');
                    $('#securityForm button[type="submit"]').prop('disabled', false);
                }
            });
        });


        function showToast(title, body, titleClass) {
            const toastHtml = `
                <div class="toast align-items-center text-bg-light border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000">
                    <div class="toast-header">
                        <strong class="me-auto ${titleClass}">${title}</strong>
                        <small class="text-muted">Now</small>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">${body}</div>
                </div>`;

            const $toast = $(toastHtml);
            $('.toast-container').append($toast);
            const toast = new bootstrap.Toast($toast[0]);
            toast.show();
        }

        $(document).ready(function () {
            $('#logout-link').on('click', function (e) {
                e.preventDefault();

                console.log('reached')
                $.ajax({
                    type: 'POST',
                    url: '/user/logout',
                    contentType: 'application/json',
                    success: function (response) {
                        showToast("Success", "Logged out in successfully", "text-success");
                        window.location.href = '/'
                    },
                    error: function (xhr) {
                        let message = "Request failed. Please try again.";
                        if (xhr.responseJSON && xhr.responseJSON.message) {
                            message = xhr.responseJSON.message;
                        }
                        showToast("Error", message, "text-danger");
                        return;
                    },
                });
            })

            function showToast(title, body, titleClass) {
                const toastHtml = `
                <div class="toast align-items-center text-bg-light border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="5000">
                    <div class="toast-header">
                        <strong class="me-auto ${titleClass}">${title}</strong>
                        <small class="text-muted">Now</small>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">${body}</div>
                </div>`;

                const $toast = $(toastHtml);
                $('.toast-container').append($toast);
                const toast = new bootstrap.Toast($toast[0]);
                toast.show();
            }
        })
    </script>


</body>

<!-- Mirrored from demos.themeselection.com/sneat-bootstrap-html-admin-template/html/vertical-menu-template/form-layouts-vertical.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 19 Jul 2025 20:47:12 GMT -->

</html>

<!-- beautify ignore:end -->